dynamics = [
999.000,1.000,0.000;
999.000,1.000,0.000;
999.000,1.000,0.000;
999.000,1.000,0.000;
998.875,1.092,0.033;
998.750,1.183,0.067;
998.625,1.275,0.100;
998.489,1.375,0.136;
998.341,1.483,0.176;
998.182,1.599,0.218;
998.011,1.725,0.264;
997.826,1.861,0.314;
997.626,2.007,0.367;
997.411,2.165,0.424;
997.179,2.335,0.486;
996.929,2.518,0.553;
996.659,2.716,0.625;
996.368,2.929,0.703;
996.054,3.159,0.787;
995.715,3.407,0.878;
995.351,3.674,0.975;
994.957,3.962,1.081;
994.533,4.272,1.194;
994.076,4.607,1.317;
993.583,4.968,1.449;
993.052,5.357,1.591;
992.480,5.775,1.745;
991.863,6.227,1.910;
991.198,6.713,2.089;
990.481,7.237,2.281;
989.709,7.802,2.489;
988.878,8.410,2.713;
987.982,9.064,2.954;
987.016,9.769,3.214;
985.977,10.529,3.494;
984.858,11.346,3.797;
983.652,12.226,4.122;
982.355,13.172,4.473;
980.958,14.191,4.851;
979.455,15.287,5.259;
977.837,16.465,5.698;
976.097,17.732,6.171;
974.225,19.094,6.680;
972.213,20.558,7.229;
970.049,22.130,7.820;
967.724,23.819,8.457;
965.226,25.632,9.142;
962.542,27.578,9.880;
959.661,29.665,10.674;
956.569,31.903,11.528;
953.250,34.302,12.447;
949.692,36.872,13.436;
945.877,39.623,14.500;
941.790,42.567,15.643;
937.413,45.715,16.872;
932.728,49.079,18.193;
927.717,52.671,19.612;
922.360,56.504,21.136;
916.638,60.590,22.772;
910.530,64.943,24.527;
904.015,69.574,26.411;
897.073,74.497,28.431;
889.681,79.724,30.595;
881.819,85.266,32.914;
873.466,91.137,35.398;
864.600,97.345,38.055;
855.201,103.902,40.897;
845.250,110.815,43.935;
834.730,118.090,47.180;
823.623,125.734,50.643;
811.914,133.748,54.337;
799.593,142.134,58.274;
786.648,150.887,62.465;
773.074,160.003,66.923;
758.868,169.471,71.661;
744.031,179.279,76.690;
728.569,189.407,82.024;
712.493,199.834,87.673;
695.820,210.532,93.649;
678.570,221.467,99.962;
660.773,232.604,106.624;
642.461,243.898,113.641;
623.676,255.301,121.023;
604.464,266.759,128.777;
584.877,278.216,136.907;
564.974,289.609,145.417;
544.818,300.873,154.309;
524.478,311.940,163.583;
504.025,322.739,173.236;
483.535,333.200,183.266;
463.084,343.252,193.663;
442.751,352.828,204.421;
422.611,361.861,215.528;
402.742,370.288,226.970;
383.215,378.054,238.731;
364.099,385.108,250.793;
345.458,391.406,263.136;
327.349,396.914,275.738;
309.821,401.604,288.574;
292.920,405.459,301.621;
276.678,408.470,314.852;
261.125,410.636,328.239;
246.279,411.967,341.754;
232.153,412.478,355.370;
218.749,412.193,369.057;
206.067,411.144,382.790;
194.097,409.364,396.539;
182.826,406.895,410.279;
172.236,403.781,423.984;
162.304,400.067,437.629;
153.005,395.803,451.192;
144.312,391.037,464.652;
136.195,385.818,477.987;
128.625,380.194,491.181;
121.571,374.214,504.215;
115.003,367.921,517.076;
108.890,361.361,529.749;
103.203,354.574,542.223;
97.914,347.599,554.487;
92.996,340.472,566.532;
88.422,333.227,578.351;
84.167,325.895,589.938;
80.209,318.504,601.287;
76.526,311.079,612.394;
73.098,303.645,623.258;
69.904,296.221,633.874;
66.929,288.828,644.244;
64.154,281.481,654.365;
61.566,274.195,664.239;
59.149,266.984,673.867;
56.892,259.858,683.250;
54.782,252.829,692.389;
52.808,245.903,701.289;
50.960,239.089,709.951;
49.229,232.393,718.378;
47.605,225.819,726.575;
46.082,219.373,734.545;
44.652,213.056,742.291;
43.309,206.873,749.819;
42.045,200.824,757.131;
40.856,194.911,764.233;
39.736,189.136,771.129;
38.680,183.497,777.823;
37.685,177.995,784.320;
36.746,172.630,790.624;
35.858,167.401,796.741;
35.020,162.306,802.674;
34.227,157.345,808.428;
33.477,152.515,814.008;
32.766,147.815,819.419;
32.093,143.244,824.663;
31.455,138.798,829.747;
30.849,134.476,834.674;
30.275,130.276,839.449;
29.729,126.195,844.076;
29.210,122.231,848.558;
28.717,118.382,852.901;
28.248,114.644,857.107;
27.802,111.016,861.182;
27.377,107.495,865.128;
26.972,104.078,868.949;
26.587,100.764,872.650;
26.219,97.548,876.233;
25.868,94.430,879.702;
25.533,91.406,883.061;
25.213,88.474,886.313;
24.908,85.632,889.460;
24.616,82.877,892.507;
24.337,80.206,895.456;
24.071,77.619,898.311;
23.816,75.111,901.073;
23.572,72.681,903.747;
23.338,70.328,906.334;
23.115,68.048,908.838;
22.900,65.839,911.261;
22.695,63.700,913.605;
22.499,61.628,915.873;
22.310,59.622,918.068;
22.129,57.680,920.191;
21.956,55.799,922.245;
21.790,53.977,924.233;
21.630,52.214,926.155;
21.477,50.508,928.015;
21.330,48.855,929.815;
21.189,47.256,931.555;
21.053,45.708,933.239;
20.923,44.210,934.867;
20.798,42.760,936.442;
20.678,41.356,937.966;
20.562,39.998,939.440;
20.451,38.684,940.865;
20.344,37.413,942.243;
20.241,36.182,943.577;
20.142,34.992,944.866;
20.047,33.840,946.113;
19.956,32.725,947.319;
19.867,31.647,948.486;
19.783,30.604,949.614;
19.701,29.594,950.705;
19.622,28.618,951.759;
19.547,27.674,952.780;
19.474,26.760,953.766;
19.404,25.876,954.720;
19.336,25.021,955.642;
19.271,24.195,956.534;
19.208,23.395,957.397;
19.148,22.621,958.231;
19.089,21.873,959.038;
19.033,21.149,959.817;
18.979,20.449,960.571;
18.927,19.773,961.300;
18.877,19.118,962.005;
18.828,18.485,962.687;
18.781,17.872,963.346;
18.736,17.280,963.983;
18.693,16.708,964.600;
18.651,16.154,965.195;
18.610,15.618,965.771;
18.571,15.100,966.328;
18.534,14.600,966.867;
18.497,14.115,967.387;
18.462,13.647,967.891;
18.428,13.194,968.377;
18.396,12.756,968.848;
18.364,12.333,969.303;
18.334,11.924,969.743;
18.305,11.528,970.168;
18.276,11.145,970.579;
18.249,10.775,970.976;
18.222,10.417,971.361;
18.197,10.071,971.732;
18.172,9.736,972.091;
18.149,9.413,972.439;
18.126,9.100,972.774;
18.104,8.798,973.099;
18.082,8.505,973.413;
18.062,8.222,973.716;
18.042,7.949,974.009;
18.023,7.685,974.293;
18.004,7.429,974.567;
17.986,7.182,974.832;
17.969,6.943,975.088;
17.952,6.712,975.335;
17.936,6.489,975.575;
17.920,6.273,975.806;
17.905,6.065,976.030;
17.891,5.863,976.246;
17.877,5.668,976.455;
17.863,5.479,976.658;
17.850,5.297,976.853;
17.837,5.121,977.042;
17.825,4.950,977.225;
17.813,4.786,977.401;
17.802,4.626,977.572;
17.791,4.472,977.737;
17.780,4.323,977.896;
17.770,4.180,978.051;
17.760,4.040,978.200;
17.750,3.906,978.344;
17.741,3.776,978.483;
17.732,3.650,978.618;
17.723,3.529,978.748;
17.715,3.411,978.874;
17.707,3.298,978.996;
17.699,3.188,979.113;
17.692,3.082,979.227;
17.684,2.979,979.337;
17.677,2.880,979.443;
17.670,2.784,979.546;
17.664,2.691,979.645;
17.657,2.602,979.741;
17.651,2.515,979.834;
17.645,2.431,979.924;
17.640,2.350,980.010;
17.634,2.272,980.094;
17.629,2.196,980.175;
17.624,2.123,980.253;
17.619,2.052,980.329;
17.614,1.984,980.402;
17.609,1.918,980.473;
17.604,1.854,980.542;
17.600,1.792,980.608;
17.596,1.732,980.672;
17.592,1.675,980.733;
17.588,1.619,980.793;
17.584,1.565,980.851;
17.580,1.513,980.907;
17.577,1.462,980.961;
17.573,1.414,981.013;
17.570,1.367,981.063;
17.567,1.321,981.112;
17.564,1.277,981.159;
17.561,1.235,981.205;
17.558,1.193,981.249;
17.555,1.154,981.291;
17.552,1.115,981.332;
17.550,1.078,981.372;
17.547,1.042,981.411;
17.545,1.007,981.448;
17.542,0.974,981.484;
17.540,0.941,981.519;
];
steps = 300;
dt = 0.5;
replications = 0;
startingTime = 0;
endTime = steps * dt;
time = 0 : dt : endTime;
susceptible = dynamics (:, 1);
infected = dynamics (:, 2);
recovered = dynamics (:, 3);
totalPopulation = susceptible(1) + infected(1) + recovered(1);
susceptibleRatio = susceptible ./ totalPopulation;
infectedRatio = infected ./ totalPopulation;
recoveredRatio = recovered ./ totalPopulation;
figure
plot (time, susceptibleRatio.', 'color', 'blue', 'linewidth', 3);
hold on
plot (time, infectedRatio.', 'color', 'red', 'linewidth', 3);
hold on
plot (time, recoveredRatio.', 'color', 'green', 'linewidth', 3);
set(gca,'YTick',0:0.05:1.0)
set(gca,'XTick',0:10:endTime)
xlabel ('Time');
ylabel ('Population Ratio');
legend('Susceptible','Infected', 'Recovered');
titleStr = sprintf('SIR Dynamics of %i agents, with 0.50 dt, 300 steps, 0 replications', totalPopulation)
title (titleStr);
