dynamics = [
0.00,999.000,1.000,0.000;
1.00,999.000,1.000,0.000;
2.00,999.000,1.000,0.000;
3.00,999.000,1.000,0.000;
4.00,998.750,1.183,0.067;
5.00,998.500,1.366,0.133;
6.00,998.251,1.549,0.200;
7.00,997.955,1.766,0.279;
8.00,997.614,2.016,0.370;
9.00,997.228,2.299,0.473;
10.00,996.787,2.622,0.591;
11.00,996.284,2.990,0.725;
12.00,995.711,3.410,0.879;
13.00,995.058,3.889,1.053;
14.00,994.313,4.434,1.253;
15.00,993.464,5.056,1.480;
16.00,992.497,5.764,1.739;
17.00,991.395,6.570,2.035;
18.00,990.139,7.489,2.372;
19.00,988.709,8.535,2.756;
20.00,987.080,9.725,3.194;
21.00,985.226,11.080,3.694;
22.00,983.117,12.621,4.263;
23.00,980.717,14.372,4.911;
24.00,977.988,16.363,5.650;
25.00,974.886,18.623,6.491;
26.00,971.362,21.189,7.449;
27.00,967.362,24.099,8.540;
28.00,962.823,27.396,9.781;
29.00,957.677,31.129,11.194;
30.00,951.849,35.350,12.801;
31.00,945.255,40.118,14.627;
32.00,937.802,45.496,16.702;
33.00,929.390,51.551,19.059;
34.00,919.910,58.357,21.733;
35.00,909.243,65.990,24.767;
36.00,897.265,74.531,28.203;
37.00,883.845,84.062,32.094;
38.00,868.844,94.663,36.493;
39.00,852.126,106.412,41.462;
40.00,833.551,119.383,47.066;
41.00,812.990,133.634,53.377;
42.00,790.320,149.209,60.471;
43.00,765.442,166.128,68.430;
44.00,738.282,184.380,77.339;
45.00,708.801,203.913,87.286;
46.00,677.011,224.628,98.361;
47.00,642.980,246.367,110.653;
48.00,606.846,268.906,124.247;
49.00,568.827,291.950,139.223;
50.00,529.225,315.128,155.647;
51.00,488.429,337.997,173.574;
52.00,446.912,360.051,193.037;
53.00,405.218,380.736,214.046;
54.00,363.946,399.475,236.579;
55.00,323.719,415.699,260.582;
56.00,285.148,428.887,285.965;
57.00,248.802,438.602,312.596;
58.00,215.159,444.531,340.310;
59.00,184.585,446.513,368.902;
60.00,157.304,444.554,398.142;
61.00,133.393,438.830,427.778;
62.00,112.788,429.667,457.545;
63.00,95.305,417.513,487.182;
64.00,80.671,402.891,516.437;
65.00,68.556,386.362,545.082;
66.00,58.608,368.476,572.916;
67.00,50.483,349.742,599.776;
68.00,43.861,330.606,625.533;
69.00,38.462,311.440,650.098;
70.00,34.048,292.538,673.414;
71.00,30.423,274.123,695.455;
72.00,27.428,256.355,716.217;
73.00,24.938,239.342,735.720;
74.00,22.853,223.152,753.995;
75.00,21.095,207.820,771.085;
76.00,19.603,193.356,787.041;
77.00,18.328,179.754,801.918;
78.00,17.232,166.995,815.773;
79.00,16.285,155.052,828.663;
80.00,15.461,143.893,840.647;
81.00,14.742,133.479,851.780;
82.00,14.110,123.773,862.116;
83.00,13.554,114.737,871.709;
84.00,13.062,106.330,880.608;
85.00,12.626,98.515,888.859;
86.00,12.237,91.255,896.509;
87.00,11.890,84.513,903.597;
88.00,11.579,78.257,910.165;
89.00,11.299,72.452,916.248;
90.00,11.048,67.069,921.883;
91.00,10.822,62.078,927.100;
92.00,10.617,57.453,931.930;
93.00,10.432,53.167,936.401;
94.00,10.264,49.196,940.540;
95.00,10.111,45.519,944.370;
96.00,9.973,42.113,947.914;
97.00,9.846,38.959,951.194;
98.00,9.731,36.040,954.229;
99.00,9.626,33.337,957.036;
100.00,9.530,30.836,959.634;
101.00,9.443,28.521,962.036;
102.00,9.363,26.379,964.259;
103.00,9.289,24.396,966.314;
104.00,9.222,22.562,968.216;
105.00,9.160,20.866,969.974;
106.00,9.103,19.296,971.601;
107.00,9.051,17.844,973.105;
108.00,9.004,16.500,974.496;
109.00,8.960,15.258,975.782;
110.00,8.919,14.109,976.972;
111.00,8.882,13.046,978.072;
112.00,8.848,12.063,979.089;
113.00,8.817,11.154,980.030;
114.00,8.788,10.313,980.900;
115.00,8.761,9.535,981.704;
116.00,8.736,8.816,982.447;
117.00,8.714,8.152,983.135;
118.00,8.693,7.537,983.771;
119.00,8.673,6.968,984.358;
120.00,8.656,6.443,984.902;
121.00,8.639,5.956,985.404;
122.00,8.624,5.507,985.869;
123.00,8.610,5.091,986.298;
124.00,8.597,4.707,986.695;
125.00,8.586,4.352,987.062;
126.00,8.575,4.024,987.402;
127.00,8.564,3.720,987.716;
128.00,8.555,3.439,988.006;
129.00,8.547,3.179,988.274;
130.00,8.539,2.939,988.522;
131.00,8.531,2.717,988.751;
132.00,8.524,2.512,988.963;
133.00,8.518,2.323,989.159;
134.00,8.512,2.147,989.340;
135.00,8.507,1.985,989.508;
136.00,8.502,1.835,989.663;
137.00,8.497,1.697,989.806;
138.00,8.493,1.569,989.938;
139.00,8.489,1.450,990.061;
140.00,8.486,1.341,990.174;
141.00,8.482,1.239,990.278;
142.00,8.479,1.146,990.375;
143.00,8.476,1.059,990.464;
144.00,8.474,0.979,990.547;
145.00,8.471,0.905,990.623;
146.00,8.469,0.837,990.694;
147.00,8.467,0.774,990.759;
148.00,8.465,0.715,990.820;
149.00,8.463,0.661,990.875;
150.00,8.462,0.611,990.927;
];
time = dynamics (:, 1);
susceptible = dynamics (:, 2);
infected = dynamics (:, 3);
recovered = dynamics (:, 4);
totalPopulation = susceptible(1) + infected(1) + recovered(1);
susceptibleRatio = susceptible ./ totalPopulation;
infectedRatio = infected ./ totalPopulation;
recoveredRatio = recovered ./ totalPopulation;
steps = length (time);
indices = 0 : steps - 1;
replications = 0;
figure
plot (indices, susceptibleRatio.', 'color', 'blue', 'linewidth', 2);
hold on
plot (indices, infectedRatio.', 'color', 'red', 'linewidth', 2);
hold on
plot (indices, recoveredRatio.', 'color', 'green', 'linewidth', 2);
set(gca,'YTick',0:0.05:1.0);
set(gca,'XTick', indices(1:10:end), 'xticklabel', time(1:10:end));
xlabel ('Time');
ylabel ('Population Ratio');
legend('Susceptible','Infected', 'Recovered');
%titleStr = sprintf('SIR Dynamics of %i agents, with 1.00 dt, %i steps, 0 replications', totalPopulation, steps)
%title (titleStr);
