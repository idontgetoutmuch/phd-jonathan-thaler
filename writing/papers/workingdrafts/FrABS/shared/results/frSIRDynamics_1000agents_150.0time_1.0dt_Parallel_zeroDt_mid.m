dynamics = [
0.00,990.000,10.000,0.000;
1.00,990.000,10.000,0.000;
2.00,990.000,9.000,1.000;
3.00,990.000,9.000,1.000;
4.00,989.000,10.000,1.000;
5.00,988.000,11.000,1.000;
6.00,986.000,12.000,2.000;
7.00,985.000,13.000,2.000;
8.00,984.000,14.000,2.000;
9.00,981.000,17.000,2.000;
10.00,977.000,20.000,3.000;
11.00,972.000,20.000,8.000;
12.00,970.000,21.000,9.000;
13.00,963.000,26.000,11.000;
14.00,957.000,31.000,12.000;
15.00,948.000,40.000,12.000;
16.00,940.000,46.000,14.000;
17.00,935.000,51.000,14.000;
18.00,920.000,65.000,15.000;
19.00,907.000,76.000,17.000;
20.00,892.000,84.000,24.000;
21.00,875.000,87.000,38.000;
22.00,862.000,96.000,42.000;
23.00,846.000,105.000,49.000;
24.00,820.000,127.000,53.000;
25.00,791.000,149.000,60.000;
26.00,765.000,167.000,68.000;
27.00,743.000,178.000,79.000;
28.00,715.000,193.000,92.000;
29.00,692.000,200.000,108.000;
30.00,662.000,210.000,128.000;
31.00,624.000,240.000,136.000;
32.00,583.000,267.000,150.000;
33.00,537.000,295.000,168.000;
34.00,505.000,312.000,183.000;
35.00,481.000,313.000,206.000;
36.00,441.000,333.000,226.000;
37.00,411.000,345.000,244.000;
38.00,388.000,342.000,270.000;
39.00,369.000,344.000,287.000;
40.00,347.000,342.000,311.000;
41.00,319.000,343.000,338.000;
42.00,286.000,348.000,366.000;
43.00,257.000,358.000,385.000;
44.00,240.000,350.000,410.000;
45.00,230.000,343.000,427.000;
46.00,207.000,344.000,449.000;
47.00,193.000,341.000,466.000;
48.00,183.000,330.000,487.000;
49.00,169.000,318.000,513.000;
50.00,164.000,295.000,541.000;
50.00,155.000,282.000,563.000;
50.00,142.000,295.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
50.00,130.000,307.000,563.000;
51.00,130.000,307.000,563.000;
52.00,130.000,284.000,586.000;
53.00,130.000,270.000,600.000;
54.00,122.000,260.000,618.000;
55.00,115.000,243.000,642.000;
56.00,109.000,231.000,660.000;
57.00,103.000,215.000,682.000;
58.00,100.000,210.000,690.000;
59.00,98.000,196.000,706.000;
60.00,96.000,186.000,718.000;
61.00,95.000,178.000,727.000;
62.00,93.000,166.000,741.000;
63.00,89.000,163.000,748.000;
64.00,86.000,159.000,755.000;
65.00,82.000,150.000,768.000;
66.00,77.000,147.000,776.000;
67.00,77.000,134.000,789.000;
68.00,75.000,129.000,796.000;
69.00,74.000,122.000,804.000;
70.00,72.000,114.000,814.000;
71.00,67.000,109.000,824.000;
72.00,63.000,104.000,833.000;
73.00,61.000,97.000,842.000;
74.00,60.000,96.000,844.000;
75.00,58.000,94.000,848.000;
76.00,57.000,86.000,857.000;
77.00,56.000,81.000,863.000;
78.00,55.000,76.000,869.000;
79.00,54.000,70.000,876.000;
80.00,53.000,65.000,882.000;
81.00,52.000,58.000,890.000;
82.00,50.000,58.000,892.000;
83.00,49.000,58.000,893.000;
84.00,47.000,56.000,897.000;
85.00,47.000,55.000,898.000;
86.00,47.000,53.000,900.000;
87.00,46.000,49.000,905.000;
88.00,46.000,47.000,907.000;
89.00,44.000,42.000,914.000;
90.00,44.000,41.000,915.000;
91.00,44.000,39.000,917.000;
92.00,44.000,37.000,919.000;
93.00,44.000,36.000,920.000;
94.00,44.000,34.000,922.000;
95.00,43.000,33.000,924.000;
96.00,43.000,29.000,928.000;
97.00,42.000,29.000,929.000;
98.00,42.000,27.000,931.000;
99.00,42.000,27.000,931.000;
100.00,42.000,26.000,932.000;
101.00,42.000,26.000,932.000;
102.00,42.000,25.000,933.000;
103.00,41.000,24.000,935.000;
104.00,38.000,25.000,937.000;
105.00,38.000,22.000,940.000;
106.00,36.000,22.000,942.000;
107.00,36.000,22.000,942.000;
108.00,36.000,21.000,943.000;
109.00,36.000,19.000,945.000;
110.00,36.000,18.000,946.000;
111.00,36.000,15.000,949.000;
112.00,35.000,13.000,952.000;
113.00,34.000,14.000,952.000;
114.00,34.000,12.000,954.000;
115.00,34.000,11.000,955.000;
116.00,34.000,10.000,956.000;
117.00,34.000,10.000,956.000;
118.00,34.000,9.000,957.000;
119.00,34.000,7.000,959.000;
120.00,34.000,6.000,960.000;
121.00,34.000,6.000,960.000;
122.00,34.000,6.000,960.000;
123.00,34.000,5.000,961.000;
124.00,34.000,4.000,962.000;
125.00,34.000,4.000,962.000;
126.00,34.000,3.000,963.000;
127.00,34.000,3.000,963.000;
128.00,34.000,3.000,963.000;
129.00,33.000,4.000,963.000;
130.00,33.000,4.000,963.000;
131.00,33.000,3.000,964.000;
132.00,33.000,2.000,965.000;
133.00,33.000,2.000,965.000;
134.00,33.000,2.000,965.000;
135.00,33.000,2.000,965.000;
136.00,33.000,0.000,967.000;
137.00,33.000,0.000,967.000;
138.00,33.000,0.000,967.000;
139.00,33.000,0.000,967.000;
140.00,33.000,0.000,967.000;
141.00,33.000,0.000,967.000;
142.00,33.000,0.000,967.000;
143.00,33.000,0.000,967.000;
144.00,33.000,0.000,967.000;
145.00,33.000,0.000,967.000;
146.00,33.000,0.000,967.000;
147.00,33.000,0.000,967.000;
148.00,33.000,0.000,967.000;
149.00,33.000,0.000,967.000;
150.00,33.000,0.000,967.000;
];
time = dynamics (:, 1);
susceptible = dynamics (:, 2);
infected = dynamics (:, 3);
recovered = dynamics (:, 4);
totalPopulation = susceptible(1) + infected(1) + recovered(1);
susceptibleRatio = susceptible ./ totalPopulation;
infectedRatio = infected ./ totalPopulation;
recoveredRatio = recovered ./ totalPopulation;
steps = length (time);
indices = 0 : steps - 1;
replications = 0;
figure
plot (indices, susceptibleRatio.', 'color', 'blue', 'linewidth', 3);
hold on
plot (indices, infectedRatio.', 'color', 'red', 'linewidth', 3);
hold on
plot (indices, recoveredRatio.', 'color', 'green', 'linewidth', 3);
hold on
x = 51;
plot([x,x],[0,1], 'color', 'black', 'linewidth', 2);
x = 101;
plot([x,x],[0,1], 'color', 'black', 'linewidth', 2);

set(gca,'YTick',0:0.05:1.0);
set(gca,'XTick', indices(1:10:end), 'xticklabel', time(1:10:end));
xlabel ('Time');
ylabel ('Population Ratio');
legend('Susceptible','Infected', 'Recovered', 'Ranges of dt=0');
titleStr = sprintf('SIR Dynamics of %i agents, with 1.00 dt, %i steps, 0 replications', totalPopulation, steps)
title (titleStr);
