dynamics = [
990.000,10.000,0.000;
990.000,10.000,0.000;
988.700,10.300,1.000;
986.400,12.550,1.050;
983.150,15.750,1.100;
980.350,17.900,1.750;
976.600,20.350,3.050;
971.900,24.350,3.750;
966.900,28.200,4.900;
961.050,32.750,6.200;
954.400,37.150,8.450;
947.500,40.150,12.350;
939.850,45.850,14.300;
931.200,50.650,18.150;
920.900,57.300,21.800;
911.150,63.600,25.250;
898.650,71.650,29.700;
885.600,80.100,34.300;
871.050,89.600,39.350;
854.800,99.400,45.800;
836.200,112.250,51.550;
817.850,124.150,58.000;
796.500,137.350,66.150;
775.750,149.500,74.750;
751.300,163.950,84.750;
726.050,179.350,94.600;
700.200,192.400,107.400;
671.350,208.150,120.500;
642.700,222.150,135.150;
614.850,237.250,147.900;
583.550,254.250,162.200;
552.450,269.850,177.700;
522.450,282.400,195.150;
492.500,295.500,212.000;
460.200,308.600,231.200;
428.400,320.150,251.450;
400.550,326.650,272.800;
373.400,334.300,292.300;
347.100,337.500,315.400;
322.850,340.900,336.250;
298.450,344.200,357.350;
275.300,345.000,379.700;
256.350,342.550,401.100;
238.550,337.550,423.900;
220.950,335.750,443.300;
205.000,330.000,465.000;
190.200,324.250,485.550;
176.850,315.500,507.650;
164.400,304.900,530.700;
152.650,294.600,552.750;
141.600,284.850,573.550;
131.250,277.050,591.700;
123.500,266.650,609.850;
115.800,257.950,626.250;
109.550,246.500,643.950;
103.000,236.200,660.800;
96.800,225.950,677.250;
92.200,214.900,692.900;
87.200,205.600,707.200;
82.350,196.300,721.350;
78.750,185.650,735.600;
75.350,175.350,749.300;
71.200,168.250,760.550;
68.850,158.800,772.350;
66.300,150.650,783.050;
63.700,142.950,793.350;
61.300,134.650,804.050;
59.150,126.450,814.400;
57.600,118.950,823.450;
56.300,112.150,831.550;
54.750,105.500,839.750;
53.450,100.000,846.550;
52.300,94.700,853.000;
51.800,88.850,859.350;
50.500,83.250,866.250;
49.500,78.750,871.750;
48.600,75.000,876.400;
47.750,70.800,881.450;
47.000,66.250,886.750;
46.400,62.600,891.000;
45.800,58.950,895.250;
45.200,55.750,899.050;
44.500,52.500,903.000;
43.700,49.350,906.950;
43.150,46.400,910.450;
42.600,44.100,913.300;
42.400,41.400,916.200;
42.050,39.100,918.850;
41.650,37.500,920.850;
41.250,35.600,923.150;
40.650,33.850,925.500;
40.400,31.800,927.800;
40.050,30.250,929.700;
39.600,29.700,930.700;
39.250,28.300,932.450;
39.050,27.000,933.950;
38.500,26.400,935.100;
38.200,25.200,936.600;
38.100,23.850,938.050;
37.800,22.900,939.300;
37.750,21.700,940.550;
37.600,20.100,942.300;
37.500,18.550,943.950;
37.300,17.300,945.400;
37.250,15.800,946.950;
37.150,14.900,947.950;
36.900,14.100,949.000;
36.700,13.200,950.100;
36.600,12.350,951.050;
36.400,11.750,951.850;
36.300,10.800,952.900;
36.250,10.450,953.300;
36.200,9.700,954.100;
36.150,8.800,955.050;
36.000,8.250,955.750;
35.900,8.050,956.050;
35.900,7.650,956.450;
35.850,7.300,956.850;
35.850,6.850,957.300;
35.700,6.300,958.000;
35.600,6.050,958.350;
35.600,5.600,958.800;
35.550,5.300,959.150;
35.500,4.750,959.750;
35.350,4.550,960.100;
35.250,4.300,960.450;
35.200,4.000,960.800;
35.150,3.700,961.150;
35.100,3.550,961.350;
35.100,3.250,961.650;
35.100,2.850,962.050;
35.100,2.600,962.300;
35.050,2.450,962.500;
35.050,2.300,962.650;
35.000,2.250,962.750;
34.950,2.050,963.000;
34.950,1.950,963.100;
34.950,1.550,963.500;
34.950,1.450,963.600;
34.950,1.400,963.650;
34.950,1.300,963.750;
34.950,1.200,963.850;
34.950,1.050,964.000;
34.950,1.050,964.000;
34.950,0.900,964.150;
34.950,0.850,964.200;
34.950,0.750,964.300;
34.900,0.750,964.350;
34.900,0.550,964.550;
34.900,0.400,964.700;
34.900,0.350,964.750;
];
susceptible = dynamics (:, 1);
infected = dynamics (:, 2);
recovered = dynamics (:, 3);
totalPopulation = susceptible(1) + infected(1) + recovered(1);
susceptibleRatio = susceptible ./ totalPopulation;
infectedRatio = infected ./ totalPopulation;
recoveredRatio = recovered ./ totalPopulation;
steps = length (susceptible);
dt = 1.0;
replications = 20;
startingTime = 0;
endTime = (steps - 1) * dt;
time = 0 : dt : endTime;
figure
plot (time, susceptibleRatio.', 'color', 'blue', 'linewidth', 3);
hold on
plot (time, infectedRatio.', 'color', 'red', 'linewidth', 3);
hold on
plot (time, recoveredRatio.', 'color', 'green', 'linewidth', 3);
set(gca,'YTick',0:0.05:1.0)
set(gca,'XTick',0:10:endTime)
xlabel ('Time');
ylabel ('Population Ratio');
legend('Susceptible','Infected', 'Recovered');
titleStr = sprintf('SIR Dynamics of %i agents, with 1.00 dt, %i steps, 20 replications', totalPopulation, steps)
title (titleStr);
