dynamics = [
90.000,10.000,0.000;
90.000,10.000,0.000;
88.950,11.050,0.000;
87.100,11.900,1.000;
84.700,13.000,2.300;
82.200,14.250,3.550;
80.050,15.800,4.150;
77.250,18.000,4.750;
73.950,20.750,5.300;
70.550,23.150,6.300;
67.950,23.350,8.700;
63.850,26.650,9.500;
60.250,28.350,11.400;
57.200,29.250,13.550;
53.050,31.300,15.650;
49.150,33.400,17.450;
45.250,35.300,19.450;
42.200,36.300,21.500;
39.300,37.200,23.500;
36.200,38.450,25.350;
33.600,39.200,27.200;
31.400,38.400,30.200;
28.800,38.500,32.700;
26.100,38.100,35.800;
24.050,38.350,37.600;
21.550,38.850,39.600;
20.000,38.400,41.600;
18.600,37.800,43.600;
16.800,37.800,45.400;
15.500,36.600,47.900;
14.550,35.450,50.000;
13.100,34.750,52.150;
12.000,33.450,54.550;
11.200,32.450,56.350;
10.400,31.000,58.600;
9.650,29.700,60.650;
9.200,27.200,63.600;
8.900,25.350,65.750;
8.650,24.200,67.150;
8.050,23.350,68.600;
7.300,22.300,70.400;
7.000,21.100,71.900;
6.700,19.750,73.550;
6.450,18.800,74.750;
6.150,17.700,76.150;
5.900,16.150,77.950;
5.600,15.150,79.250;
5.350,14.750,79.900;
5.150,13.600,81.250;
4.850,12.850,82.300;
4.700,12.200,83.100;
4.550,11.200,84.250;
4.450,10.700,84.850;
4.350,9.900,85.750;
4.150,9.350,86.500;
4.000,8.950,87.050;
3.850,8.850,87.300;
3.750,8.250,88.000;
3.650,8.000,88.350;
3.550,7.650,88.800;
3.550,7.250,89.200;
3.500,6.650,89.850;
3.400,6.350,90.250;
3.200,6.400,90.400;
3.150,6.000,90.850;
3.050,5.450,91.500;
3.050,5.250,91.700;
2.950,5.000,92.050;
2.850,5.000,92.150;
2.850,4.650,92.500;
2.800,4.250,92.950;
2.800,4.150,93.050;
2.800,3.800,93.400;
2.800,3.600,93.600;
2.800,3.450,93.750;
2.750,3.400,93.850;
2.750,3.250,94.000;
2.700,3.100,94.200;
2.700,3.000,94.300;
2.650,2.750,94.600;
2.650,2.650,94.700;
2.650,2.500,94.850;
2.650,2.300,95.050;
2.650,2.050,95.300;
2.600,1.950,95.450;
2.550,1.850,95.600;
2.550,1.800,95.650;
2.550,1.650,95.800;
2.500,1.550,95.950;
2.450,1.550,96.000;
2.450,1.450,96.100;
2.450,1.200,96.350;
2.450,1.200,96.350;
2.450,1.100,96.450;
2.450,1.000,96.550;
2.450,0.900,96.650;
2.450,0.850,96.700;
2.450,0.750,96.800;
2.450,0.700,96.850;
2.450,0.550,97.000;
2.450,0.500,97.050;
2.450,0.500,97.050;
2.450,0.400,97.150;
2.450,0.400,97.150;
2.450,0.350,97.200;
2.450,0.300,97.250;
2.450,0.300,97.250;
2.450,0.250,97.300;
2.450,0.150,97.400;
2.450,0.150,97.400;
2.450,0.100,97.450;
2.450,0.100,97.450;
2.450,0.100,97.450;
2.450,0.100,97.450;
2.450,0.100,97.450;
2.450,0.100,97.450;
2.450,0.100,97.450;
2.450,0.100,97.450;
2.450,0.100,97.450;
2.450,0.100,97.450;
2.450,0.100,97.450;
2.450,0.050,97.500;
2.450,0.050,97.500;
2.450,0.050,97.500;
2.450,0.050,97.500;
2.450,0.050,97.500;
2.450,0.050,97.500;
2.450,0.050,97.500;
2.450,0.050,97.500;
2.450,0.000,97.550;
2.450,0.000,97.550;
2.450,0.000,97.550;
2.450,0.000,97.550;
2.450,0.000,97.550;
2.450,0.000,97.550;
2.450,0.000,97.550;
2.450,0.000,97.550;
2.450,0.000,97.550;
2.450,0.000,97.550;
2.450,0.000,97.550;
2.450,0.000,97.550;
2.450,0.000,97.550;
2.450,0.000,97.550;
2.450,0.000,97.550;
2.450,0.000,97.550;
2.450,0.000,97.550;
2.450,0.000,97.550;
2.450,0.000,97.550;
2.450,0.000,97.550;
2.450,0.000,97.550;
2.450,0.000,97.550;
];
susceptible = dynamics (:, 1);
infected = dynamics (:, 2);
recovered = dynamics (:, 3);
totalPopulation = susceptible(1) + infected(1) + recovered(1);
susceptibleRatio = susceptible ./ totalPopulation;
infectedRatio = infected ./ totalPopulation;
recoveredRatio = recovered ./ totalPopulation;
steps = length (susceptible);
dt = 1.0;
replications = 20;
startingTime = 0;
endTime = (steps - 1) * dt;
time = 0 : dt : endTime;
figure
plot (time, susceptibleRatio.', 'color', 'blue', 'linewidth', 3);
hold on
plot (time, infectedRatio.', 'color', 'red', 'linewidth', 3);
hold on
plot (time, recoveredRatio.', 'color', 'green', 'linewidth', 3);
set(gca,'YTick',0:0.05:1.0)
set(gca,'XTick',0:10:endTime)
xlabel ('Time');
ylabel ('Population Ratio');
legend('Susceptible','Infected', 'Recovered');
titleStr = sprintf('SIR Dynamics of %i agents, with 1.00 dt, %i steps, 20 replications', totalPopulation, steps)
title (titleStr);
