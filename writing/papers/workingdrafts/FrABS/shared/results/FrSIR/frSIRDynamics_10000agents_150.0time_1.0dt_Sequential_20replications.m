dynamics = [
9990.000,10.000,0.000;
9990.000,10.000,0.000;
9988.750,11.250,0.000;
9986.000,13.900,0.100;
9983.500,15.200,1.300;
9980.150,17.100,2.750;
9976.450,18.150,5.400;
9972.600,20.400,7.000;
9968.150,24.050,7.800;
9962.850,28.100,9.050;
9956.400,33.600,10.000;
9948.550,38.850,12.600;
9940.350,44.800,14.850;
9930.300,52.850,16.850;
9919.250,60.650,20.100;
9907.050,69.900,23.050;
9892.900,78.500,28.600;
9876.500,90.250,33.250;
9857.800,102.450,39.750;
9836.400,118.050,45.550;
9810.950,135.650,53.400;
9782.250,156.050,61.700;
9750.900,178.750,70.350;
9712.750,204.950,82.300;
9671.000,233.050,95.950;
9623.900,266.150,109.950;
9571.400,301.650,126.950;
9510.750,343.700,145.550;
9442.050,389.750,168.200;
9365.050,439.750,195.200;
9277.300,500.350,222.350;
9179.500,565.300,255.200;
9069.950,638.300,291.750;
8951.000,714.900,334.100;
8813.100,807.700,379.200;
8659.950,907.700,432.350;
8493.200,1017.800,489.000;
8313.500,1127.350,559.150;
8114.900,1253.800,631.300;
7902.100,1386.200,711.700;
7673.300,1523.900,802.800;
7422.950,1673.000,904.050;
7163.050,1825.850,1011.100;
6882.100,1984.750,1133.150;
6595.300,2139.200,1265.500;
6297.250,2297.250,1405.500;
5989.100,2458.250,1552.650;
5681.850,2606.550,1711.600;
5359.000,2756.900,1884.100;
5044.950,2894.100,2060.950;
4735.400,3015.500,2249.100;
4431.850,3118.350,2449.800;
4139.800,3204.700,2655.500;
3850.850,3284.550,2864.600;
3575.350,3348.500,3076.150;
3316.150,3396.500,3287.350;
3071.050,3414.950,3514.000;
2837.050,3427.550,3735.400;
2620.600,3421.950,3957.450;
2419.150,3398.100,4182.750;
2241.650,3345.400,4412.950;
2077.550,3292.950,4629.500;
1921.000,3237.750,4841.250;
1783.300,3163.750,5052.950;
1656.700,3081.200,5262.100;
1541.400,2991.750,5466.850;
1438.200,2897.800,5664.000;
1344.700,2804.300,5851.000;
1261.150,2705.300,6033.550;
1183.000,2613.300,6203.700;
1113.100,2513.450,6373.450;
1048.850,2410.950,6540.200;
990.750,2308.200,6701.050;
935.300,2210.250,6854.450;
885.800,2116.800,6997.400;
841.750,2020.950,7137.300;
803.250,1927.200,7269.550;
769.300,1834.350,7396.350;
736.750,1747.650,7515.600;
707.250,1661.200,7631.550;
677.500,1577.700,7744.800;
653.600,1496.000,7850.400;
631.150,1419.500,7949.350;
609.350,1346.950,8043.700;
590.350,1279.300,8130.350;
571.850,1214.950,8213.200;
555.250,1154.400,8290.350;
540.850,1093.000,8366.150;
527.450,1030.300,8442.250;
515.200,977.200,8507.600;
503.800,925.900,8570.300;
491.850,874.950,8633.200;
482.100,826.450,8691.450;
472.350,781.400,8746.250;
464.750,737.850,8797.400;
456.750,700.200,8843.050;
448.600,663.800,8887.600;
442.500,625.550,8931.950;
436.200,590.200,8973.600;
430.100,559.600,9010.300;
424.200,528.400,9047.400;
418.700,502.400,9078.900;
413.950,475.450,9110.600;
409.950,450.100,9139.950;
405.600,425.650,9168.750;
402.000,402.100,9195.900;
398.900,380.650,9220.450;
394.950,361.900,9243.150;
391.750,342.850,9265.400;
387.900,325.150,9286.950;
384.700,306.250,9309.050;
381.700,291.050,9327.250;
378.900,276.050,9345.050;
376.500,260.500,9363.000;
373.850,247.900,9378.250;
371.700,234.750,9393.550;
370.050,221.100,9408.850;
368.450,207.000,9424.550;
366.650,195.050,9438.300;
365.000,185.300,9449.700;
363.150,175.700,9461.150;
361.550,164.700,9473.750;
360.000,154.450,9485.550;
358.600,145.650,9495.750;
357.700,135.500,9506.800;
356.650,126.850,9516.500;
355.950,119.000,9525.050;
355.150,111.400,9533.450;
354.150,105.800,9540.050;
353.550,99.600,9546.850;
352.850,93.400,9553.750;
352.400,87.850,9559.750;
351.800,82.550,9565.650;
351.300,77.350,9571.350;
350.750,73.550,9575.700;
350.050,69.250,9580.700;
349.550,65.500,9584.950;
349.250,61.750,9589.000;
348.750,58.700,9592.550;
348.100,55.650,9596.250;
347.850,51.650,9600.500;
347.400,49.250,9603.350;
347.050,46.450,9606.500;
346.750,43.450,9609.800;
346.450,40.600,9612.950;
346.400,38.000,9615.600;
345.850,35.800,9618.350;
345.750,33.800,9620.450;
345.550,31.800,9622.650;
345.450,30.250,9624.300;
345.150,27.950,9626.900;
];
susceptible = dynamics (:, 1);
infected = dynamics (:, 2);
recovered = dynamics (:, 3);
totalPopulation = susceptible(1) + infected(1) + recovered(1);
susceptibleRatio = susceptible ./ totalPopulation;
infectedRatio = infected ./ totalPopulation;
recoveredRatio = recovered ./ totalPopulation;
steps = length (susceptible);
dt = 1.0;
replications = 20;
startingTime = 0;
endTime = (steps - 1) * dt;
time = 0 : dt : endTime;
figure
plot (time, susceptibleRatio.', 'color', 'blue', 'linewidth', 3);
hold on
plot (time, infectedRatio.', 'color', 'red', 'linewidth', 3);
hold on
plot (time, recoveredRatio.', 'color', 'green', 'linewidth', 3);
set(gca,'YTick',0:0.05:1.0)
set(gca,'XTick',0:10:endTime)
xlabel ('Time');
ylabel ('Population Ratio');
legend('Susceptible','Infected', 'Recovered');
titleStr = sprintf('SIR Dynamics of %i agents, with 1.00 dt, %i steps, 20 replications Seq', totalPopulation, steps)
title (titleStr);
