dynamics = [
990.000,10.000,0.000;
990.000,10.000,0.000;
988.700,10.300,1.000;
986.120,12.820,1.060;
982.860,15.880,1.260;
979.680,18.540,1.780;
976.100,20.780,3.120;
971.860,24.300,3.840;
966.860,28.240,4.900;
961.000,32.780,6.220;
954.400,36.980,8.620;
946.860,40.640,12.500;
938.100,47.100,14.800;
929.120,52.680,18.200;
918.320,60.060,21.620;
907.180,67.500,25.320;
893.760,75.960,30.280;
879.500,85.740,34.760;
863.820,96.320,39.860;
846.260,107.800,45.940;
826.680,121.100,52.220;
805.880,135.180,58.940;
783.960,149.000,67.040;
759.920,163.380,76.700;
734.020,178.780,87.200;
707.180,194.820,98.000;
678.440,209.720,111.840;
647.560,227.040,125.400;
617.520,241.520,140.960;
587.060,257.140,155.800;
555.740,272.400,171.860;
524.000,287.200,188.800;
492.760,300.140,207.100;
462.340,311.160,226.500;
431.120,323.260,245.620;
401.780,331.880,266.340;
374.480,336.820,288.700;
348.040,342.020,309.940;
322.480,344.260,333.260;
298.760,345.640,355.600;
276.440,346.060,377.500;
255.740,344.880,399.380;
236.920,342.340,420.740;
219.140,337.080,443.780;
202.320,332.500,465.180;
187.940,324.520,487.540;
174.420,317.700,507.880;
161.860,309.080,529.060;
150.900,298.180,550.920;
140.460,288.640,570.900;
130.760,278.080,591.160;
121.460,268.760,609.780;
114.020,257.740,628.240;
106.900,248.240,644.860;
101.080,236.820,662.100;
95.480,226.340,678.180;
90.280,216.400,693.320;
85.940,205.900,708.160;
81.500,197.160,721.340;
77.120,188.360,734.520;
74.080,178.700,747.220;
70.740,169.460,759.800;
67.700,161.300,771.000;
65.640,151.160,783.200;
63.260,142.880,793.860;
61.020,135.400,803.580;
58.660,128.480,812.860;
57.020,120.740,822.240;
55.520,113.280,831.200;
53.940,106.860,839.200;
52.540,100.220,847.240;
51.340,94.520,854.140;
50.140,89.580,860.280;
49.400,84.000,866.600;
48.360,79.220,872.420;
47.520,74.900,877.580;
46.680,70.720,882.600;
45.920,66.680,887.400;
45.240,62.740,892.020;
44.540,59.200,896.260;
43.920,56.020,900.060;
43.340,52.540,904.120;
42.840,49.340,907.820;
42.320,46.820,910.860;
41.820,44.520,913.660;
41.360,42.120,916.520;
41.020,39.540,919.440;
40.700,37.400,921.900;
40.320,35.640,924.040;
40.020,33.920,926.060;
39.620,32.080,928.300;
39.440,30.040,930.520;
39.020,28.540,932.440;
38.700,27.380,933.920;
38.440,25.900,935.660;
38.200,25.040,936.760;
37.860,24.120,938.020;
37.620,22.780,939.600;
37.520,21.620,940.860;
37.360,20.120,942.520;
37.220,18.900,943.880;
37.120,17.720,945.160;
36.920,16.560,946.520;
36.720,15.580,947.700;
36.680,14.680,948.640;
36.520,13.760,949.720;
36.340,13.020,950.640;
36.160,12.140,951.700;
36.080,11.320,952.600;
35.960,10.660,953.380;
35.860,9.760,954.380;
35.760,9.320,954.920;
35.680,8.600,955.720;
35.620,7.940,956.440;
35.540,7.300,957.160;
35.480,6.820,957.700;
35.460,6.420,958.120;
35.380,6.180,958.440;
35.360,5.780,958.860;
35.280,5.320,959.400;
35.240,5.020,959.740;
35.180,4.660,960.160;
35.160,4.320,960.520;
35.140,3.800,961.060;
35.060,3.580,961.360;
35.020,3.320,961.660;
34.980,3.060,961.960;
34.960,2.800,962.240;
34.940,2.700,962.360;
34.900,2.540,962.560;
34.840,2.380,962.780;
34.820,2.240,962.940;
34.800,2.140,963.060;
34.800,2.020,963.180;
34.760,1.960,963.280;
34.740,1.800,963.460;
34.700,1.680,963.620;
34.700,1.400,963.900;
34.680,1.380,963.940;
34.680,1.300,964.020;
34.680,1.200,964.120;
34.680,1.060,964.260;
34.680,0.940,964.380;
34.680,0.920,964.400;
34.660,0.820,964.520;
34.660,0.720,964.620;
34.660,0.660,964.680;
34.640,0.600,964.760;
34.640,0.500,964.860;
34.620,0.400,964.980;
34.600,0.400,965.000;
];
susceptible = dynamics (:, 1);
infected = dynamics (:, 2);
recovered = dynamics (:, 3);
totalPopulation = susceptible(1) + infected(1) + recovered(1);
susceptibleRatio = susceptible ./ totalPopulation;
infectedRatio = infected ./ totalPopulation;
recoveredRatio = recovered ./ totalPopulation;
steps = length (susceptible);
dt = 1.0;
replications = 50;
startingTime = 0;
endTime = (steps - 1) * dt;
time = 0 : dt : endTime;
figure
plot (time, susceptibleRatio.', 'color', 'blue', 'linewidth', 3);
hold on
plot (time, infectedRatio.', 'color', 'red', 'linewidth', 3);
hold on
plot (time, recoveredRatio.', 'color', 'green', 'linewidth', 3);
set(gca,'YTick',0:0.05:1.0)
set(gca,'XTick',0:10:endTime)
xlabel ('Time');
ylabel ('Population Ratio');
legend('Susceptible','Infected', 'Recovered');
titleStr = sprintf('SIR Dynamics of %i agents, with 1.00 dt, %i steps, 50 replications', totalPopulation, steps)
title (titleStr);
