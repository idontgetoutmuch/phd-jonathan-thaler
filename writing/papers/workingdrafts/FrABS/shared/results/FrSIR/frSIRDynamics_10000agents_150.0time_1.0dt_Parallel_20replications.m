dynamics = [
9990.000,10.000,0.000;
9990.000,10.000,0.000;
9990.000,10.000,0.000;
9987.350,12.650,0.000;
9985.400,13.350,1.250;
9982.450,15.100,2.450;
9979.150,15.900,4.950;
9976.050,17.400,6.550;
9972.250,20.750,7.000;
9967.750,24.200,8.050;
9962.950,28.250,8.800;
9957.350,31.400,11.250;
9950.700,36.450,12.850;
9943.050,42.200,14.750;
9933.600,49.250,17.150;
9924.350,56.200,19.450;
9914.350,62.050,23.600;
9901.700,71.450,26.850;
9887.250,81.650,31.100;
9871.550,91.250,37.200;
9855.550,101.550,42.900;
9833.450,117.200,49.350;
9811.800,131.300,56.900;
9785.050,150.150,64.800;
9755.350,171.050,73.600;
9721.850,192.550,85.600;
9683.100,220.350,96.550;
9641.150,248.350,110.500;
9592.450,279.150,128.400;
9541.800,313.200,145.000;
9480.600,353.700,165.700;
9415.100,396.450,188.450;
9340.050,445.950,214.000;
9258.550,498.150,243.300;
9164.700,561.650,273.650;
9065.500,623.800,310.700;
8950.700,696.850,352.450;
8824.050,779.400,396.550;
8689.200,862.900,447.900;
8536.250,959.800,503.950;
8369.600,1062.700,567.700;
8194.500,1167.200,638.300;
8001.150,1285.750,713.100;
7793.550,1406.450,800.000;
7572.200,1537.800,890.000;
7337.700,1673.300,989.000;
7084.850,1816.750,1098.400;
6825.750,1957.300,1216.950;
6552.750,2097.200,1350.050;
6270.350,2243.800,1485.850;
5983.200,2386.450,1630.350;
5686.350,2528.300,1785.350;
5386.750,2660.850,1952.400;
5087.050,2788.400,2124.550;
4790.850,2901.750,2307.400;
4505.300,2997.550,2497.150;
4213.350,3090.600,2696.050;
3937.450,3168.600,2893.950;
3675.250,3226.450,3098.300;
3422.100,3272.050,3305.850;
3179.800,3293.650,3526.550;
2946.800,3316.950,3736.250;
2730.350,3319.200,3950.450;
2531.650,3293.750,4174.600;
2342.550,3265.250,4392.200;
2171.950,3224.150,4603.900;
2017.050,3171.700,4811.250;
1869.500,3111.900,5018.600;
1740.250,3037.100,5222.650;
1620.300,2954.900,5424.800;
1511.350,2871.800,5616.850;
1411.600,2785.400,5803.000;
1321.450,2690.800,5987.750;
1239.950,2598.250,6161.800;
1166.400,2506.500,6327.100;
1100.300,2409.850,6489.850;
1035.400,2312.700,6651.900;
979.150,2220.400,6800.450;
927.300,2121.850,6950.850;
879.350,2026.400,7094.250;
835.750,1940.950,7223.300;
799.850,1851.950,7348.200;
765.000,1765.700,7469.300;
734.600,1680.050,7585.350;
705.550,1596.850,7697.600;
678.350,1516.100,7805.550;
652.750,1441.000,7906.250;
629.300,1369.200,8001.500;
607.550,1302.000,8090.450;
588.550,1233.000,8178.450;
570.400,1172.750,8256.850;
554.300,1112.650,8333.050;
539.750,1054.900,8405.350;
525.800,997.600,8476.600;
514.700,942.350,8542.950;
504.300,890.900,8604.800;
491.500,846.450,8662.050;
482.050,799.500,8718.450;
472.950,757.000,8770.050;
464.500,713.700,8821.800;
455.900,677.450,8866.650;
448.650,642.800,8908.550;
441.750,608.850,8949.400;
436.200,574.600,8989.200;
430.600,542.900,9026.500;
425.850,513.700,9060.450;
419.750,488.400,9091.850;
414.800,462.200,9123.000;
410.250,437.550,9152.200;
406.150,412.750,9181.100;
402.500,390.100,9207.400;
398.700,368.900,9232.400;
395.150,349.800,9255.050;
392.150,332.900,9274.950;
389.700,313.300,9297.000;
386.500,295.900,9317.600;
383.600,282.450,9333.950;
380.650,268.800,9350.550;
377.850,255.450,9366.700;
375.150,239.800,9385.050;
372.850,226.800,9400.350;
370.350,212.650,9417.000;
368.550,200.850,9430.600;
366.750,189.550,9443.700;
364.800,179.450,9455.750;
363.200,169.100,9467.700;
361.900,158.650,9479.450;
360.250,149.700,9490.050;
359.250,140.000,9500.750;
358.000,131.550,9510.450;
356.700,124.050,9519.250;
355.550,116.800,9527.650;
354.600,109.500,9535.900;
353.800,103.650,9542.550;
353.150,97.450,9549.400;
352.650,91.150,9556.200;
351.900,85.700,9562.400;
350.850,81.350,9567.800;
349.900,77.050,9573.050;
349.300,73.000,9577.700;
348.450,68.850,9582.700;
347.800,64.800,9587.400;
347.300,61.200,9591.500;
346.750,58.350,9594.900;
346.200,54.850,9598.950;
345.650,51.850,9602.500;
345.450,48.650,9605.900;
345.050,46.200,9608.750;
344.700,43.450,9611.850;
344.250,40.900,9614.850;
343.950,38.400,9617.650;
];
susceptible = dynamics (:, 1);
infected = dynamics (:, 2);
recovered = dynamics (:, 3);
totalPopulation = susceptible(1) + infected(1) + recovered(1);
susceptibleRatio = susceptible ./ totalPopulation;
infectedRatio = infected ./ totalPopulation;
recoveredRatio = recovered ./ totalPopulation;
steps = length (susceptible);
dt = 1.0;
replications = 20;
startingTime = 0;
endTime = (steps - 1) * dt;
time = 0 : dt : endTime;
figure
plot (time, susceptibleRatio.', 'color', 'blue', 'linewidth', 3);
hold on
plot (time, infectedRatio.', 'color', 'red', 'linewidth', 3);
hold on
plot (time, recoveredRatio.', 'color', 'green', 'linewidth', 3);
set(gca,'YTick',0:0.05:1.0)
set(gca,'XTick',0:10:endTime)
xlabel ('Time');
ylabel ('Population Ratio');
legend('Susceptible','Infected', 'Recovered');
titleStr = sprintf('SIR Dynamics of %i agents, with 1.00 dt, %i steps, 20 replications', totalPopulation, steps)
title (titleStr);
