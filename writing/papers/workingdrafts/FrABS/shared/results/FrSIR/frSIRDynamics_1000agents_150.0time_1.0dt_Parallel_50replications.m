dynamics = [
990.000,10.000,0.000;
990.000,10.000,0.000;
990.000,9.000,1.000;
987.520,11.480,1.000;
984.980,13.920,1.100;
982.020,16.540,1.440;
979.100,18.060,2.840;
976.040,20.660,3.300;
971.540,24.300,4.160;
967.000,27.900,5.100;
961.620,31.180,7.200;
955.740,33.480,10.780;
948.700,38.580,12.720;
941.420,43.040,15.540;
933.380,48.360,18.260;
924.000,55.040,20.960;
914.640,59.940,25.420;
902.760,68.200,29.040;
890.420,76.240,33.340;
876.820,85.180,38.000;
862.120,94.500,43.380;
845.620,105.600,48.780;
828.360,116.960,54.680;
809.420,129.340,61.240;
788.640,142.440,68.920;
766.100,156.000,77.900;
743.280,168.380,88.340;
716.900,184.640,98.460;
691.840,196.600,111.560;
663.700,212.040,124.260;
634.640,227.360,138.000;
605.100,242.000,152.900;
576.800,254.960,168.240;
545.760,270.220,184.020;
515.960,283.220,200.820;
485.300,295.960,218.740;
456.340,305.840,237.820;
427.160,315.840,257.000;
399.360,321.460,279.180;
372.700,326.720,300.580;
347.960,329.840,322.200;
323.560,334.000,342.440;
299.960,336.620,363.420;
278.480,337.000,384.520;
258.780,334.500,406.720;
239.620,332.160,428.220;
222.120,328.160,449.720;
205.220,323.560,471.220;
191.260,315.860,492.880;
177.840,308.220,513.940;
165.520,299.620,534.860;
153.700,291.500,554.800;
143.180,282.680,574.140;
133.580,272.760,593.660;
125.040,262.860,612.100;
116.960,253.120,629.920;
110.120,242.700,647.180;
103.140,233.380,663.480;
97.560,223.500,678.940;
92.260,213.040,694.700;
87.640,203.000,709.360;
83.360,194.720,721.920;
79.540,185.760,734.700;
76.120,175.840,748.040;
72.400,167.680,759.920;
69.120,159.640,771.240;
66.600,151.240,782.160;
64.320,143.180,792.500;
61.900,135.460,802.640;
60.060,127.060,812.880;
58.200,119.760,822.040;
56.700,113.140,830.160;
55.240,106.080,838.680;
53.820,100.060,846.120;
52.520,94.860,852.620;
51.140,89.940,858.920;
50.060,84.560,865.380;
49.240,79.800,870.960;
48.080,75.500,876.420;
47.240,70.620,882.140;
46.540,66.520,886.940;
45.900,62.960,891.140;
45.260,59.020,895.720;
44.700,55.780,899.520;
44.060,52.940,903.000;
43.360,50.120,906.520;
42.760,47.440,909.800;
42.340,44.700,912.960;
41.800,42.300,915.900;
41.320,40.000,918.680;
40.980,38.100,920.920;
40.560,36.480,922.960;
40.300,34.280,925.420;
40.000,32.200,927.800;
39.780,30.560,929.660;
39.500,28.640,931.860;
39.180,27.400,933.420;
39.020,25.800,935.180;
38.740,24.480,936.780;
38.420,23.480,938.100;
38.240,22.100,939.660;
38.060,20.900,941.040;
37.820,19.820,942.360;
37.600,18.660,943.740;
37.480,17.660,944.860;
37.300,16.320,946.380;
37.160,15.460,947.380;
37.060,14.400,948.540;
36.860,13.660,949.480;
36.740,12.840,950.420;
36.580,12.160,951.260;
36.440,11.300,952.260;
36.340,10.700,952.960;
36.160,9.920,953.920;
36.080,9.200,954.720;
35.920,8.700,955.380;
35.860,8.040,956.100;
35.760,7.480,956.760;
35.740,7.120,957.140;
35.600,6.720,957.680;
35.560,6.240,958.200;
35.500,5.900,958.600;
35.460,5.440,959.100;
35.440,5.080,959.480;
35.400,4.740,959.860;
35.380,4.440,960.180;
35.360,3.960,960.680;
35.320,3.660,961.020;
35.320,3.380,961.300;
35.280,3.240,961.480;
35.200,3.020,961.780;
35.200,2.720,962.080;
35.180,2.460,962.360;
35.140,2.300,962.560;
35.120,2.160,962.720;
35.060,2.040,962.900;
35.000,1.900,963.100;
35.000,1.780,963.220;
34.980,1.620,963.400;
34.980,1.500,963.520;
34.940,1.400,963.660;
34.940,1.360,963.700;
34.940,1.260,963.800;
34.940,1.160,963.900;
34.900,1.140,963.960;
34.880,1.100,964.020;
34.880,1.000,964.120;
34.880,0.940,964.180;
34.880,0.880,964.240;
34.880,0.860,964.260;
34.880,0.780,964.340;
];
susceptible = dynamics (:, 1);
infected = dynamics (:, 2);
recovered = dynamics (:, 3);
totalPopulation = susceptible(1) + infected(1) + recovered(1);
susceptibleRatio = susceptible ./ totalPopulation;
infectedRatio = infected ./ totalPopulation;
recoveredRatio = recovered ./ totalPopulation;
steps = length (susceptible);
dt = 1.0;
replications = 50;
startingTime = 0;
endTime = (steps - 1) * dt;
time = 0 : dt : endTime;
figure
plot (time, susceptibleRatio.', 'color', 'blue', 'linewidth', 3);
hold on
plot (time, infectedRatio.', 'color', 'red', 'linewidth', 3);
hold on
plot (time, recoveredRatio.', 'color', 'green', 'linewidth', 3);
set(gca,'YTick',0:0.05:1.0)
set(gca,'XTick',0:10:endTime)
xlabel ('Time');
ylabel ('Population Ratio');
legend('Susceptible','Infected', 'Recovered');
titleStr = sprintf('SIR Dynamics of %i agents, with 1.00 dt, %i steps, 50 replications', totalPopulation, steps)
title (titleStr);
