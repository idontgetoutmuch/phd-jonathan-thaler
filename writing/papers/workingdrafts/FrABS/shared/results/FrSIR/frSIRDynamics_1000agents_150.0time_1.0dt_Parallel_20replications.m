dynamics = [
990.000,10.000,0.000;
990.000,10.000,0.000;
990.000,9.000,1.000;
987.600,11.400,1.000;
985.250,13.700,1.050;
982.350,16.250,1.400;
979.700,17.400,2.900;
976.600,20.150,3.250;
971.850,24.100,4.050;
967.550,27.550,4.900;
961.700,31.150,7.150;
956.500,32.900,10.600;
949.550,38.050,12.400;
943.100,41.950,14.950;
935.800,46.150,18.050;
926.350,52.950,20.700;
918.100,56.800,25.100;
905.950,65.150,28.900;
895.950,71.250,32.800;
883.000,79.950,37.050;
868.450,88.550,43.000;
853.900,97.550,48.550;
838.800,106.850,54.350;
820.950,118.350,60.700;
801.800,130.950,67.250;
781.000,143.500,75.500;
759.900,155.100,85.000;
735.150,169.600,95.250;
711.400,181.650,106.950;
685.850,194.700,119.450;
656.850,211.100,132.050;
630.400,223.250,146.350;
602.600,237.950,159.450;
573.700,252.150,174.150;
543.950,266.700,189.350;
512.350,282.000,205.650;
484.300,291.250,224.450;
454.100,304.250,241.650;
425.650,310.300,264.050;
399.150,316.750,284.100;
373.300,321.550,305.150;
348.150,327.100,324.750;
323.400,332.000,344.600;
300.150,335.300,364.550;
279.200,333.500,387.300;
257.650,334.200,408.150;
239.950,331.350,428.700;
223.450,327.700,448.850;
207.900,320.350,471.750;
193.900,313.150,492.950;
180.150,305.050,514.800;
167.100,297.550,535.350;
155.600,288.700,555.700;
145.350,279.300,575.350;
136.350,270.550,593.100;
127.850,262.250,609.900;
119.850,252.150,628.000;
112.400,242.550,645.050;
106.000,231.800,662.200;
99.800,222.150,678.050;
94.350,211.600,694.050;
89.250,202.800,707.950;
84.650,194.150,721.200;
80.900,183.350,735.750;
76.700,174.600,748.700;
73.000,166.250,760.750;
70.150,158.350,771.500;
67.150,150.650,782.200;
64.550,142.750,792.700;
63.000,132.850,804.150;
60.750,125.300,813.950;
59.350,118.550,822.100;
57.800,110.850,831.350;
56.200,105.400,838.400;
54.700,100.450,844.850;
53.450,96.000,850.550;
52.150,90.000,857.850;
51.050,84.800,864.150;
49.750,80.350,869.900;
48.950,75.300,875.750;
48.300,70.100,881.600;
47.800,66.000,886.200;
47.200,61.950,890.850;
46.350,59.100,894.550;
45.850,56.250,897.900;
45.250,52.750,902.000;
44.500,50.050,905.450;
44.050,46.800,909.150;
43.550,43.700,912.750;
42.900,41.200,915.900;
42.550,39.450,918.000;
41.950,38.000,920.050;
41.750,35.750,922.500;
41.350,33.900,924.750;
41.100,32.300,926.600;
40.750,30.650,928.600;
40.350,29.500,930.150;
40.250,27.750,932.000;
39.950,26.300,933.750;
39.550,25.250,935.200;
39.300,24.000,936.700;
39.150,22.850,938.000;
38.900,22.050,939.050;
38.850,20.850,940.300;
38.550,19.650,941.800;
38.250,18.200,943.550;
38.150,17.000,944.850;
38.000,16.000,946.000;
37.850,15.100,947.050;
37.750,14.200,948.050;
37.450,13.450,949.100;
37.250,12.650,950.100;
37.150,11.900,950.950;
36.950,10.800,952.250;
36.850,10.250,952.900;
36.700,9.450,953.850;
36.700,8.850,954.450;
36.600,8.400,955.000;
36.550,7.950,955.500;
36.350,7.650,956.000;
36.300,7.100,956.600;
36.250,6.850,956.900;
36.200,6.400,957.400;
36.200,5.900,957.900;
36.100,5.550,958.350;
36.100,5.200,958.700;
36.100,4.650,959.250;
36.050,4.350,959.600;
36.050,4.150,959.800;
35.950,4.050,960.000;
35.850,3.750,960.400;
35.850,3.400,960.750;
35.800,3.200,961.000;
35.750,2.850,961.400;
35.700,2.850,961.450;
35.700,2.500,961.800;
35.700,2.150,962.150;
35.700,1.950,962.350;
35.700,1.650,962.650;
35.700,1.500,962.800;
35.700,1.350,962.950;
35.700,1.350,962.950;
35.700,1.200,963.100;
35.700,1.100,963.200;
35.650,1.100,963.250;
35.650,1.000,963.350;
35.650,0.900,963.450;
35.650,0.850,963.500;
35.650,0.800,963.550;
35.650,0.800,963.550;
35.650,0.750,963.600;
];
susceptible = dynamics (:, 1);
infected = dynamics (:, 2);
recovered = dynamics (:, 3);
totalPopulation = susceptible(1) + infected(1) + recovered(1);
susceptibleRatio = susceptible ./ totalPopulation;
infectedRatio = infected ./ totalPopulation;
recoveredRatio = recovered ./ totalPopulation;
steps = length (susceptible);
dt = 1.0;
replications = 20;
startingTime = 0;
endTime = (steps - 1) * dt;
time = 0 : dt : endTime;
figure
plot (time, susceptibleRatio.', 'color', 'blue', 'linewidth', 3);
hold on
plot (time, infectedRatio.', 'color', 'red', 'linewidth', 3);
hold on
plot (time, recoveredRatio.', 'color', 'green', 'linewidth', 3);
set(gca,'YTick',0:0.05:1.0)
set(gca,'XTick',0:10:endTime)
xlabel ('Time');
ylabel ('Population Ratio');
legend('Susceptible','Infected', 'Recovered');
titleStr = sprintf('SIR Dynamics of %i agents, with 1.00 dt, %i steps, 20 replications', totalPopulation, steps)
title (titleStr);
