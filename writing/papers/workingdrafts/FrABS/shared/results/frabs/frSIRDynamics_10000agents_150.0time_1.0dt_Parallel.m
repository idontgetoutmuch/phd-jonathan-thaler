dynamics = [
0.00,9990.000,10.000,0.000;
1.00,9990.000,10.000,0.000;
2.00,9990.000,10.000,0.000;
3.00,9990.000,10.000,0.000;
4.00,9986.000,13.000,1.000;
5.00,9982.000,16.000,2.000;
6.00,9976.000,18.000,6.000;
7.00,9969.000,24.000,7.000;
8.00,9961.000,31.000,8.000;
9.00,9951.000,40.000,9.000;
10.00,9943.000,45.000,12.000;
11.00,9935.000,50.000,15.000;
12.00,9928.000,55.000,17.000;
13.00,9921.000,57.000,22.000;
14.00,9910.000,67.000,23.000;
15.00,9898.000,73.000,29.000;
16.00,9880.000,84.000,36.000;
17.00,9859.000,102.000,39.000;
18.00,9838.000,115.000,47.000;
19.00,9812.000,135.000,53.000;
20.00,9780.000,159.000,61.000;
21.00,9743.000,179.000,78.000;
22.00,9700.000,209.000,91.000;
23.00,9659.000,237.000,104.000;
24.00,9607.000,274.000,119.000;
25.00,9543.000,317.000,140.000;
26.00,9474.000,368.000,158.000;
27.00,9393.000,420.000,187.000;
28.00,9300.000,491.000,209.000;
29.00,9196.000,563.000,241.000;
30.00,9090.000,637.000,273.000;
31.00,8967.000,730.000,303.000;
32.00,8835.000,828.000,337.000;
33.00,8691.000,926.000,383.000;
34.00,8539.000,1011.000,450.000;
35.00,8340.000,1139.000,521.000;
36.00,8115.000,1273.000,612.000;
37.00,7879.000,1442.000,679.000;
38.00,7629.000,1585.000,786.000;
39.00,7369.000,1747.000,884.000;
40.00,7078.000,1932.000,990.000;
41.00,6782.000,2110.000,1108.000;
42.00,6443.000,2307.000,1250.000;
43.00,6129.000,2461.000,1410.000;
44.00,5805.000,2620.000,1575.000;
45.00,5459.000,2806.000,1735.000;
46.00,5113.000,2990.000,1897.000;
47.00,4780.000,3124.000,2096.000;
48.00,4474.000,3229.000,2297.000;
49.00,4145.000,3324.000,2531.000;
50.00,3885.000,3385.000,2730.000;
51.00,3618.000,3441.000,2941.000;
52.00,3340.000,3470.000,3190.000;
53.00,3110.000,3485.000,3405.000;
54.00,2877.000,3457.000,3666.000;
55.00,2672.000,3451.000,3877.000;
56.00,2451.000,3465.000,4084.000;
57.00,2264.000,3421.000,4315.000;
58.00,2117.000,3349.000,4534.000;
59.00,1983.000,3262.000,4755.000;
60.00,1827.000,3211.000,4962.000;
61.00,1697.000,3129.000,5174.000;
62.00,1591.000,3037.000,5372.000;
63.00,1490.000,2951.000,5559.000;
64.00,1384.000,2869.000,5747.000;
65.00,1300.000,2784.000,5916.000;
66.00,1220.000,2680.000,6100.000;
67.00,1149.000,2567.000,6284.000;
68.00,1085.000,2474.000,6441.000;
69.00,1035.000,2359.000,6606.000;
70.00,972.000,2247.000,6781.000;
71.00,919.000,2154.000,6927.000;
72.00,874.000,2066.000,7060.000;
73.00,837.000,1963.000,7200.000;
74.00,803.000,1873.000,7324.000;
75.00,769.000,1771.000,7460.000;
76.00,736.000,1672.000,7592.000;
77.00,708.000,1581.000,7711.000;
78.00,685.000,1495.000,7820.000;
79.00,665.000,1410.000,7925.000;
80.00,640.000,1328.000,8032.000;
81.00,618.000,1268.000,8114.000;
82.00,601.000,1195.000,8204.000;
83.00,588.000,1119.000,8293.000;
84.00,575.000,1047.000,8378.000;
85.00,562.000,996.000,8442.000;
86.00,552.000,953.000,8495.000;
87.00,542.000,892.000,8566.000;
88.00,539.000,842.000,8619.000;
89.00,521.000,806.000,8673.000;
90.00,512.000,770.000,8718.000;
91.00,502.000,731.000,8767.000;
92.00,492.000,692.000,8816.000;
93.00,483.000,665.000,8852.000;
94.00,472.000,633.000,8895.000;
95.00,467.000,599.000,8934.000;
96.00,458.000,564.000,8978.000;
97.00,453.000,531.000,9016.000;
98.00,449.000,500.000,9051.000;
99.00,446.000,471.000,9083.000;
100.00,439.000,448.000,9113.000;
101.00,431.000,422.000,9147.000;
102.00,427.000,390.000,9183.000;
103.00,421.000,370.000,9209.000;
104.00,415.000,357.000,9228.000;
105.00,412.000,329.000,9259.000;
106.00,409.000,316.000,9275.000;
107.00,408.000,301.000,9291.000;
108.00,404.000,291.000,9305.000;
109.00,403.000,274.000,9323.000;
110.00,401.000,259.000,9340.000;
111.00,400.000,245.000,9355.000;
112.00,399.000,234.000,9367.000;
113.00,397.000,225.000,9378.000;
114.00,393.000,213.000,9394.000;
115.00,390.000,199.000,9411.000;
116.00,389.000,189.000,9422.000;
117.00,388.000,172.000,9440.000;
118.00,387.000,165.000,9448.000;
119.00,383.000,159.000,9458.000;
120.00,380.000,149.000,9471.000;
121.00,379.000,140.000,9481.000;
122.00,379.000,134.000,9487.000;
123.00,376.000,125.000,9499.000;
124.00,374.000,116.000,9510.000;
125.00,374.000,108.000,9518.000;
126.00,372.000,104.000,9524.000;
127.00,370.000,98.000,9532.000;
128.00,369.000,91.000,9540.000;
129.00,369.000,86.000,9545.000;
130.00,368.000,79.000,9553.000;
131.00,367.000,74.000,9559.000;
132.00,364.000,71.000,9565.000;
133.00,363.000,66.000,9571.000;
134.00,363.000,62.000,9575.000;
135.00,362.000,60.000,9578.000;
136.00,362.000,53.000,9585.000;
137.00,361.000,47.000,9592.000;
138.00,360.000,46.000,9594.000;
139.00,360.000,42.000,9598.000;
140.00,360.000,42.000,9598.000;
141.00,360.000,40.000,9600.000;
142.00,360.000,39.000,9601.000;
143.00,360.000,35.000,9605.000;
144.00,359.000,34.000,9607.000;
145.00,359.000,32.000,9609.000;
146.00,359.000,30.000,9611.000;
147.00,359.000,29.000,9612.000;
148.00,359.000,25.000,9616.000;
149.00,359.000,25.000,9616.000;
150.00,358.000,23.000,9619.000;
];
time = dynamics (:, 1);
susceptible = dynamics (:, 2);
infected = dynamics (:, 3);
recovered = dynamics (:, 4);
totalPopulation = susceptible(1) + infected(1) + recovered(1);
susceptibleRatio = susceptible ./ totalPopulation;
infectedRatio = infected ./ totalPopulation;
recoveredRatio = recovered ./ totalPopulation;
steps = length (time);
indices = 0 : steps - 1;
replications = 0;
figure
plot (indices, susceptibleRatio.', 'color', 'blue', 'linewidth', 2);
hold on
plot (indices, infectedRatio.', 'color', 'red', 'linewidth', 2);
hold on
plot (indices, recoveredRatio.', 'color', 'green', 'linewidth', 2);
set(gca,'YTick',0:0.05:1.0);
set(gca,'XTick', indices(1:10:end), 'xticklabel', time(1:10:end));
xlabel ('Time');
ylabel ('Population Ratio');
legend('Susceptible','Infected', 'Recovered');
%titleStr = sprintf('SIR Dynamics of %i agents, with 1.00 dt, %i steps, 0 replications', totalPopulation, steps)
%title (titleStr);
