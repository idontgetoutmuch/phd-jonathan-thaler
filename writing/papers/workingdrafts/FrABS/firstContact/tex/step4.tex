\subsection{Step IV: Generalising to Monadic Stream Functions}
- this allows us to add dynamic environments and agent transactions
- we need deterministic behaviour under all curcumstances, thus we cannot use IO or STM. for globally mutable state we use StateT
- also putting agentout into StateT monad composes now much better

TODO problem: when using my implementation of dpSwitch without notYet, then it still terminates. In Yampa we need notYet!!
TODO: test with dpSwitchB of both 

TODO:
Step IV a): just adding the monad to all functions, running in the identity monad
Step IV b): running in the random-monad
Step IV c): adding the state-monad for agentout

