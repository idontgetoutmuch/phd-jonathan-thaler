\section{Introduction}
\label{sec:introduction}
When implementing an agent-based simulation (ABS) it is of fundamental importance that the implementation is correct up to some specification and that this specification matches the real world in some way. This process is called verification and validation (V\&V), where \textit{validation} is the process of ensuring that a model or specification is sufficiently accurate for the purpose at hand whereas \textit{verification} is the process of ensuring that the model design has been transformed into a computer model with sufficient accuracy \citep{robinson_simulation:_2014}. In other words, validation determines if we are we building the \textit{right model}, and verification if we are building the \textit{model right} up to some specification \citep{balci_verification_1998}.

The work of \cite{collier_test-driven_2013} was the first to discuss how to do verification of an ABS implementation, using unit testing with the RePast Framework \citep{north_complex_2013}, to verify the correctness of an implementation up to a certain level. Unit testing is a technique, where additional code is written to test specific parts of the implementation. Each test case is constructed manually and expectations about invariants are encoded into assertions. A different approach to testing ABS implementations was investigated by the rather conceptual paper of \cite{thaler_show_2019}. In this work the authors introduced \textit{property-based testing} to ABS and showed that it allows to do both verification and validation of an implementation on the code level. The main idea of property-based testing is to express model specifications and laws directly in code and test them through \textit{automated} and \textit{randomised} test data generation. The authors showed that due to ABS' \textit{stochastic}, \textit{exploratory}, \textit{generative} and \textit{constructive} nature, property-based testing is a much more natural fit for testing both explanatory and exploratory ABS than unit testing. 

This paper picks up the conceptual work of \cite{thaler_show_2019}, puts it into a much more technical perspective and demonstrates additional techniques of property-based testing in the context of ABS, which was not covered in the conceptual paper. More specifically, this paper shows how to encode agent specifications into property-based tests, using an agent-based SIR model inspired by \cite{macal_agent-based_2010} as use case. Following an event-driven approach it is shown how to express an agent specification in code by relating random input events to specific output events. Further, showing the use of specific property-based testing features which allow expressing expected coverage of data distributions, it is shown how transition probabilities can be tested. By doing this, this paper demonstrates how property-based testing works on a technical level, how specifications can be put into code and how probabilities can be expressed and tested using statistically robust verification. This underlines the conclusion of \cite{thaler_show_2019}, that property-based testing maps naturally to ABS. Further, this work shows that in the context of ABS, property-based testing is strictly more powerful than unit testing as it allows to run thousands of test cases automatically instead of constructing each manually and because it is able to encode probabilities, something unit testing is not capable of in general.

The paper is structured as follows: in section \ref{sec:proptesting} property-based testing is introduced on a technical level. In section \ref{sec:sirmodel} the agent-based SIR model is introduced, together with its informal event-driven specification. Section \ref{sec:method} is the heart of the paper, where it is shown how to encode agent specifications and transition probabilities with property-based testing. In section \ref{sec:discussion} the approach is discussed and related to the work of \cite{thaler_show_2019} and other use cases. Finally, section \ref{sec:conclusions} concludes and points out further research.