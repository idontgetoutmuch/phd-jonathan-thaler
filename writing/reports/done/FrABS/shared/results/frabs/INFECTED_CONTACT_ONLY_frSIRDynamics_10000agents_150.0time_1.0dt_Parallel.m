dynamics = [
0.00,9990.000,10.000,0.000;
1.00,9990.000,10.000,0.000;
2.00,9990.000,10.000,0.000;
3.00,9988.000,12.000,0.000;
4.00,9987.000,12.000,1.000;
5.00,9986.000,12.000,2.000;
6.00,9984.000,12.000,4.000;
7.00,9978.000,17.000,5.000;
8.00,9977.000,18.000,5.000;
9.00,9969.000,26.000,5.000;
10.00,9968.000,27.000,5.000;
11.00,9961.000,33.000,6.000;
12.00,9958.000,36.000,6.000;
13.00,9949.000,44.000,7.000;
14.00,9938.000,55.000,7.000;
15.00,9927.000,66.000,7.000;
16.00,9922.000,70.000,8.000;
17.00,9910.000,82.000,8.000;
18.00,9885.000,107.000,8.000;
19.00,9865.000,127.000,8.000;
20.00,9839.000,152.000,9.000;
21.00,9806.000,184.000,10.000;
22.00,9776.000,213.000,11.000;
23.00,9742.000,244.000,14.000;
24.00,9702.000,284.000,14.000;
25.00,9645.000,341.000,14.000;
26.00,9582.000,396.000,22.000;
27.00,9514.000,448.000,38.000;
28.00,9444.000,505.000,51.000;
29.00,9355.000,580.000,65.000;
30.00,9235.000,686.000,79.000;
31.00,9114.000,789.000,97.000;
32.00,8976.000,895.000,129.000;
33.00,8814.000,1029.000,157.000;
34.00,8639.000,1168.000,193.000;
35.00,8449.000,1312.000,239.000;
36.00,8224.000,1480.000,296.000;
37.00,7989.000,1646.000,365.000;
38.00,7755.000,1785.000,460.000;
39.00,7488.000,1969.000,543.000;
40.00,7221.000,2138.000,641.000;
41.00,6908.000,2334.000,758.000;
42.00,6590.000,2527.000,883.000;
43.00,6253.000,2706.000,1041.000;
44.00,5913.000,2890.000,1197.000;
45.00,5587.000,3055.000,1358.000;
46.00,5257.000,3187.000,1556.000;
47.00,4918.000,3322.000,1760.000;
48.00,4588.000,3446.000,1966.000;
49.00,4280.000,3537.000,2183.000;
50.00,3987.000,3621.000,2392.000;
51.00,3673.000,3718.000,2609.000;
52.00,3411.000,3754.000,2835.000;
53.00,3154.000,3769.000,3077.000;
54.00,2905.000,3771.000,3324.000;
55.00,2689.000,3752.000,3559.000;
56.00,2493.000,3724.000,3783.000;
57.00,2321.000,3660.000,4019.000;
58.00,2130.000,3602.000,4268.000;
59.00,1962.000,3527.000,4511.000;
60.00,1823.000,3441.000,4736.000;
61.00,1701.000,3336.000,4963.000;
62.00,1544.000,3260.000,5196.000;
63.00,1443.000,3160.000,5397.000;
64.00,1344.000,3060.000,5596.000;
65.00,1268.000,2925.000,5807.000;
66.00,1194.000,2825.000,5981.000;
67.00,1120.000,2708.000,6172.000;
68.00,1050.000,2590.000,6360.000;
69.00,1001.000,2458.000,6541.000;
70.00,960.000,2346.000,6694.000;
71.00,912.000,2232.000,6856.000;
72.00,874.000,2109.000,7017.000;
73.00,831.000,1985.000,7184.000;
74.00,796.000,1864.000,7340.000;
75.00,764.000,1740.000,7496.000;
76.00,741.000,1638.000,7621.000;
77.00,715.000,1564.000,7721.000;
78.00,694.000,1450.000,7856.000;
79.00,673.000,1360.000,7967.000;
80.00,654.000,1260.000,8086.000;
81.00,631.000,1178.000,8191.000;
82.00,614.000,1084.000,8302.000;
83.00,598.000,1013.000,8389.000;
84.00,587.000,955.000,8458.000;
85.00,575.000,858.000,8567.000;
86.00,561.000,792.000,8647.000;
87.00,554.000,728.000,8718.000;
88.00,544.000,678.000,8778.000;
89.00,536.000,623.000,8841.000;
90.00,532.000,560.000,8908.000;
91.00,528.000,506.000,8966.000;
92.00,522.000,465.000,9013.000;
93.00,515.000,424.000,9061.000;
94.00,512.000,386.000,9102.000;
95.00,508.000,355.000,9137.000;
96.00,504.000,331.000,9165.000;
97.00,501.000,303.000,9196.000;
98.00,497.000,274.000,9229.000;
99.00,491.000,257.000,9252.000;
100.00,487.000,237.000,9276.000;
101.00,483.000,213.000,9304.000;
102.00,482.000,197.000,9321.000;
103.00,477.000,181.000,9342.000;
104.00,474.000,170.000,9356.000;
105.00,473.000,157.000,9370.000;
106.00,471.000,145.000,9384.000;
107.00,469.000,135.000,9396.000;
108.00,468.000,116.000,9416.000;
109.00,466.000,106.000,9428.000;
110.00,464.000,97.000,9439.000;
111.00,463.000,92.000,9445.000;
112.00,463.000,85.000,9452.000;
113.00,463.000,77.000,9460.000;
114.00,463.000,72.000,9465.000;
115.00,462.000,66.000,9472.000;
116.00,461.000,57.000,9482.000;
117.00,460.000,56.000,9484.000;
118.00,460.000,52.000,9488.000;
119.00,460.000,50.000,9490.000;
120.00,460.000,47.000,9493.000;
121.00,459.000,42.000,9499.000;
122.00,459.000,35.000,9506.000;
123.00,459.000,31.000,9510.000;
124.00,459.000,28.000,9513.000;
125.00,459.000,26.000,9515.000;
126.00,459.000,25.000,9516.000;
127.00,459.000,23.000,9518.000;
128.00,459.000,21.000,9520.000;
129.00,458.000,19.000,9523.000;
130.00,458.000,15.000,9527.000;
131.00,458.000,14.000,9528.000;
132.00,458.000,12.000,9530.000;
133.00,458.000,11.000,9531.000;
134.00,458.000,10.000,9532.000;
135.00,458.000,10.000,9532.000;
136.00,458.000,8.000,9534.000;
137.00,458.000,8.000,9534.000;
138.00,457.000,7.000,9536.000;
139.00,457.000,7.000,9536.000;
140.00,457.000,7.000,9536.000;
141.00,457.000,5.000,9538.000;
142.00,457.000,5.000,9538.000;
143.00,457.000,5.000,9538.000;
144.00,457.000,4.000,9539.000;
145.00,457.000,4.000,9539.000;
146.00,457.000,3.000,9540.000;
147.00,457.000,3.000,9540.000;
148.00,457.000,3.000,9540.000;
149.00,457.000,3.000,9540.000;
150.00,457.000,3.000,9540.000;
];
time = dynamics (:, 1);
susceptible = dynamics (:, 2);
infected = dynamics (:, 3);
recovered = dynamics (:, 4);
totalPopulation = susceptible(1) + infected(1) + recovered(1);
susceptibleRatio = susceptible ./ totalPopulation;
infectedRatio = infected ./ totalPopulation;
recoveredRatio = recovered ./ totalPopulation;
steps = length (time);
indices = 0 : steps - 1;
replications = 0;
figure
plot (indices, susceptibleRatio.', 'color', 'blue', 'linewidth', 2);
hold on
plot (indices, infectedRatio.', 'color', 'red', 'linewidth', 2);
hold on
plot (indices, recoveredRatio.', 'color', 'green', 'linewidth', 2);
set(gca,'YTick',0:0.05:1.0);
set(gca,'XTick', indices(1:10:end), 'xticklabel', time(1:10:end));
xlabel ('Time');
ylabel ('Population Ratio');
legend('Susceptible','Infected', 'Recovered');
%titleStr = sprintf('SIR Dynamics of %i agents, with 1.00 dt, %i steps, 0 replications', totalPopulation, steps)
%title (titleStr);
